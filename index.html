<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>èµ›åšä¿®ä»™ V5.1</title>
<style>
  body{font-family:sans-serif;background:#0d1117;color:#c9d1d9;margin:0;padding:10px;display:flex;flex-direction:column;align-items:center;min-height:100vh}
  #app{width:100%;max-width:800px;padding-bottom:80px}
  .box{background:rgba(22,27,34,0.8);border:1px solid #30363d;border-radius:12px;padding:15px;margin-bottom:15px;text-align:center}
  #score{font-size:3rem;color:#ffd700;text-shadow:0 0 10px rgba(255,215,0,0.4);margin:5px 0;font-weight:800}
  .grid{display:flex;gap:10px}
  .col{flex:1}
  .btn{width:100%;padding:12px;margin-bottom:8px;border:none;border-radius:6px;color:#fff;font-weight:bold;display:flex;justify-content:space-between;cursor:pointer}
  .btn.g{background:#238636} .btn.b{background:#da3633}
  canvas{width:100%;background:radial-gradient(circle at bottom,#1c2128,#0d1117);border-radius:12px;display:block}
  #quote{border-left:3px solid #58a6ff;padding:10px;background:#161b22;margin-bottom:15px;color:#8b949e}
  .bar{position:fixed;bottom:20px;background:rgba(22,27,34,0.9);padding:10px 20px;border-radius:30px;border:1px solid #333;display:flex;gap:20px;z-index:99}
</style>
</head>
<body>
<div id="app">
  <div class="box">
    <h3>ğŸ‚ èµ›åšä¿®ä»™ V5.1</h3>
    <div id="score">0</div>
    <div style="font-size:0.8em;opacity:0.7">åŠŸå¾·é‡‘å¶</div>
  </div>
  <div id="quote">ğŸ’¡ ç³»ç»Ÿæ­£å¸¸è¿è¡Œä¸­...</div>
  
  <div class="grid">
    <div class="col" id="g-box"><h4 style="text-align:center;color:#3fb950;margin:0 0 10px 0">âœ¨ æŒ‚é‡‘å¶</h4></div>
    <div class="col" id="b-box"><h4 style="text-align:center;color:#f85149;margin:0 0 10px 0">ğŸ‚ è½æ¯å¶</h4></div>
  </div>

  <div style="margin-top:15px;border:1px solid #333;border-radius:12px;overflow:hidden">
    <canvas id="cvs"></canvas>
  </div>
</div>

<div class="bar">
  <button onclick="backup()" style="background:none;border:none;font-size:1.5em">ğŸ’¾</button>
  <button onclick="restore()" style="background:none;border:none;font-size:1.5em">ğŸ“¤</button>
  <button onclick="reset()" style="background:none;border:none;font-size:1.5em;color:red">ğŸ—‘ï¸</button>
</div>

<script>
// V5.1 æç®€æ ¸å¿ƒé€»è¾‘
const DATA_KEY = 'GONGDE_V5_LITE';
const G_Acts = ['ä¸“æ³¨å·¥ä½œ', 'ç¦…ä¿®', 'å¿µä½›', 'å¸®äºº', 'èµç¾', 'æ„Ÿæ©', 'è‡ªçœ', 'æ—©èµ·', 'çœŸè¯šé“æ­‰', 'è‡ªæˆ‘æ¿€åŠ±'];
const B_Acts = ['è¯´äººæ˜¯é', 'æ¨è„±è´£ä»»', 'å‘è„¾æ°”', 'å‚²æ…¢', 'æŠ±æ€¨', 'æ‹–å»¶', 'è´ªç¡', 'æ¶è¯­', 'æ€‚æ¿', 'æ²‰è¿·'];
const Quotes = ["è§‰å¯Ÿå½“ä¸‹ï¼Œæ˜¯å”¯ä¸€èƒ½æ”¹å˜æœªæ¥çš„åŠ›é‡ã€‚",
 Â Â Â Â Â Â Â Â Â  "ä½ æ‰€ç»å†çš„æ¯ä»¶äº‹ï¼Œéƒ½ç”±ä½ è¿‡å»çš„æ¯ä¸€ä¸ªç‚¹å‡»æ‰€å¡‘é€ ã€‚",
 Â Â Â Â Â Â Â Â Â  "æˆ‘ä»¬æ— æ³•æ§åˆ¶å¤–åœ¨ä¸–ç•Œï¼Œä½†å¯¹è‡ªèº«å¿µå¤´ï¼Œæ‹¥æœ‰ç»å¯¹çš„ä¸»æƒã€‚",
 Â Â Â Â Â Â Â Â Â  "ã€Šé‡‘åˆšç»ã€‹ï¼šå‡¡æ‰€æœ‰ç›¸ï¼Œçš†æ˜¯è™šå¦„ã€‚è‹¥è§è¯¸ç›¸éç›¸ï¼Œå³è§å¦‚æ¥ã€‚",
 Â Â Â Â Â Â Â Â Â  "æŠŠæ¯ä¸€æ¬¡åˆ†å¿ƒï¼Œçœ‹ä½œä¸€æ¬¡æé†’ï¼Œè€Œéä¸€æ¬¡å¤±è´¥ã€‚",
 Â Â Â Â Â Â Â Â Â  "å–„æ¶ä¹‹æŠ¥ï¼Œå¦‚å½±éšå½¢ï¼›ä¸æ˜¯ä¸æŠ¥ï¼Œæ—¶å€™æœªåˆ°ã€‚",
 Â Â Â Â Â Â Â Â Â  "ä¹ æƒ¯çš„åŠ›é‡åœ¨äºå¤åˆ©ï¼Œæ¯å¤©1%çš„è¿›æ­¥ï¼Œä¸€å¹´æ˜¯37å€çš„å·®è·ã€‚",
 Â Â Â Â Â Â Â Â Â  "å¿ƒå¦‚å·¥ç”»å¸ˆï¼Œèƒ½ç”»è¯¸ä¸–é—´ã€‚",
 Â Â Â Â Â Â Â Â Â  "å¦‚æœä¸€ä»¶äº‹ä»¤ä½ ç—›è‹¦ï¼Œé‚£ä¹ˆä½¿ä½ ç—›è‹¦çš„å¹¶éè¿™ä»¶äº‹æœ¬èº«ï¼Œè€Œæ˜¯ä½ å¯¹å®ƒçš„åˆ¤æ–­ã€‚",
 Â Â Â Â Â Â Â Â Â  "è«ä»¥å–„å°è€Œä¸ä¸ºï¼Œè«ä»¥æ¶å°è€Œä¸ºä¹‹ã€‚"
 Â Â Â Â Â Â Â Â Â Â  "ä¸€å¿µå—”å¿ƒèµ·ï¼Œç™¾ä¸‡éšœé—¨å¼€ã€‚è§‰å¯Ÿå³æ˜¯å…³é—­éšœé—¨ã€‚",
 Â Â Â Â Â Â Â Â Â Â  "æœ€å¥½çš„ä¼‘æ¯ï¼Œæ˜¯æ¢ä¸ªé¢†åŸŸè¿›è¡Œæ·±åº¦ä¸“æ³¨ã€‚"];

let state = { score:0, leafs:0, dead:0 };
const cvs = document.getElementById('cvs');
const ctx = cvs.getContext('2d');
let tips=[], drops=[], ground=[];

function init() {
  try {
    let s = localStorage.getItem(DATA_KEY);
    if(s) state = JSON.parse(s);
  } catch(e) {}
  
  // ç”ŸæˆæŒ‰é’®
  const gb = document.getElementById('g-box');
  const bb = document.getElementById('b-box');
  G_Acts.forEach(t => gb.innerHTML += `<button class="btn g" onclick="act(1)"><span>${t}</span><span>+1</span></button>`);
  B_Acts.forEach(t => bb.innerHTML += `<button class="btn b" onclick="act(0)"><span>${t}</span><span>-1</span></button>`);
  
  renderUI();
  resize();
  loop();
}

function act(isGood) {
  if(isGood) { state.score+=100; state.leafs++; }
  else { 
    if(state.leafs>0) { state.leafs--; state.dead++; drop(false); }
    else { state.dead++; drop(true); }
    state.score-=50; 
  }
  save(); renderUI();
}

function save() { localStorage.setItem(DATA_KEY, JSON.stringify(state)); }
function renderUI() {
  document.getElementById('score').innerText = state.score;
  document.getElementById('quote').innerText = "ğŸ’¡ " + Quotes[Math.floor(Math.random()*Quotes.length)];
}

// è§†è§‰é€»è¾‘
function resize() { cvs.width = cvs.parentElement.clientWidth; cvs.height = 300; }
function loop() {
  ctx.clearRect(0,0,cvs.width,cvs.height);
  
  // æ ‘
  tips=[];
  ctx.strokeStyle='#4a5a6a'; ctx.lineWidth=6; ctx.lineCap='round';
  drawBranch(cvs.width/2, cvs.height, 80, -90, 5);
  
  // é‡‘å¶
  ctx.fillStyle='#ffd700';
  let drawN = Math.min(state.leafs, 300);
  for(let i=0; i<drawN; i++) {
    let t = tips[(i*13)%tips.length];
    if(t) { ctx.beginPath(); ctx.arc(t.x+Math.sin(i)*15, t.y+Math.cos(i)*15, 3, 0, 7); ctx.fill(); }
  }
  
  // è½å¶ä¸åœ°é¢
  ctx.fillStyle='#8b5a2b';
  // åœ°é¢
  if(ground.length < Math.min(state.dead, 200)) ground.push({x:Math.random()*cvs.width, y:cvs.height-5+Math.random()*5, r:Math.random()*6});
  ground.forEach(g => { ctx.save(); ctx.translate(g.x,g.y); ctx.rotate(g.r); ctx.fillRect(-3,-2,6,4); ctx.restore(); });
  
  // é£˜è½
  for(let i=drops.length-1; i>=0; i--) {
    let d=drops[i]; d.y+=1; d.x+=Math.sin(d.y/20); d.r+=0.1;
    ctx.save(); ctx.translate(d.x,d.y); ctx.rotate(d.r); ctx.fillRect(-3,-2,6,4); ctx.restore();
    if(d.y>cvs.height) drops.splice(i,1);
  }
  
  requestAnimationFrame(loop);
}

function drawBranch(x,y,l,a,d) {
  let ex = x + l*Math.cos(a*Math.PI/180);
  let ey = y + l*Math.sin(a*Math.PI/180);
  ctx.beginPath(); ctx.moveTo(x,y); ctx.lineTo(ex,ey); ctx.stroke();
  if(d>0) { ctx.lineWidth*=0.7; drawBranch(ex,ey,l*0.7,a-20,d-1); drawBranch(ex,ey,l*0.7,a+20,d-1); ctx.lineWidth/=0.7; }
  else tips.push({x:ex,y:ey});
}

function drop(voidDrop) {
  let x = cvs.width/2, y = 100;
  if(!voidDrop && tips.length>0) { let t=tips[Math.floor(Math.random()*tips.length)]; x=t.x; y=t.y; }
  drops.push({x:x, y:y, r:0});
}

function backup() { prompt("å¤åˆ¶:", btoa(JSON.stringify(state))); }
function restore() { try{state=JSON.parse(atob(prompt("ç²˜è´´:"))); save(); init();}catch(e){} }
function reset() { if(confirm("æ¸…ç©º?")) { localStorage.removeItem(DATA_KEY); location.reload(); } }

window.onload = init;
</script>
</body>
</html>